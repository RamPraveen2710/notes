import xgboost as xgb
import onnxmltools
from skl2onnx.common.data_types import FloatTensorType

# Assuming 'data' is your DataFrame
X = data[[...]]  # Replace with your feature columns
y = data["target"]  # Replace with your target column

# Train the XGBoost model
model = xgb.XGBRegressor()
model.fit(X, y)

# Convert the model to ONNX using onnxmltools
initial_type = [("float_input", FloatTensorType([None, X.shape[1]]))]
onnx_model = onnxmltools.convert_xgboost(model, initial_types=initial_type)

# Save the ONNX model
with open("xgb_model.onnx", "wb") as f:
    f.write(onnx_model.SerializeToString())

print("Model saved as xgb_model.onnx")
